webpackJsonp([11],{Axh0:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAAwCAYAAABE1blzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Nzc5NzQzODMzQjlCMTFFODgwRTk5QzI5MUZCQkUzQjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Nzc5NzQzODQzQjlCMTFFODgwRTk5QzI5MUZCQkUzQjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3Nzk3NDM4MTNCOUIxMUU4ODBFOTlDMjkxRkJCRTNCNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3Nzk3NDM4MjNCOUIxMUU4ODBFOTlDMjkxRkJCRTNCNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXR75kAAALpSURBVHja7JhLaBQxGMcza1sVRCvS6kEvSkFF9DCi2IIHDyqigqcqUlErPqD14JvaQgXBF+hBDyqoKCKK4MHiW2sLWi87N1EsXrzUg1Ct+K44/j+IZQmzm2Q24ybD/uHH7mSy2f3vl3z5Jl42m53HGLsK5rB06Yzv+60eDL7HxRSWTrVmUmyO1FIR0fgO9IEMxwX9ApPAcqG9WjT4FtCa/OZKiLDORt4HQbAVL+dybv8WI9TrkrkIdQnXoWiwyvE1N15sEKeoZ+GPnsv5Cl6BNwX6ejKDoUXGloJOsEhoz4IOcF9lkIylEVwPHkSYI80H98CSOAZt0ExeWcl0V2UPtzGCRxT7jQZtsiVmWwTHgsUa/ddh76vUiWCpk0wNmKDRv1rW37Yp+lmz0PgChlxKMp/AS43+z1CqDbuWRQ9r9O3UzaIm1uBUsFF1n8qT/k8rmguEtj9JG9wE+sEl8ERxP4vSTnAIfI+4Nwh28/tSmaxFl4GLERUJfcfaGONRhM6DRlAHfvI/7zr4qDqIKYN1fGpFqZEnj+0xxh0Ap4qZUiaSDG3O3ZKxtmlUKEZlwuAjnlhkOgD2ltqgbpK5ABo0+h/n0SykiWA/2GDCYEURn90DNsf43Fm+Jm9E3KsHt8Bkfk116RaNsY0V2yvBiSL+HMqEK8TCGTzPMUdqVtwTlSOoMkXpea3LwOy5A3aB12A12JGnXwuvUQ+aMCiL6Djw1GAOOKnYr42bPJZ0Fn3ISncSfpRHMzGDl/OckfxP0XpsSsLgPlNp24CugFUms+iaOHM/Yd1mhk7VZvF9yUY9BguLMUjnHT3MXtGDQU8QBLMLPSyIBkflvKeD11pmt8ZQcQCT0/MFTGwYylnIC5gbopnWB5NVvu/3ywwO8KTSxNwSlXfdMDkDrx8KVTJU2E5jboqeal6IQRMNumrun2qSeOC1WmWDZYNlgyVVZdoN/iCDwyk2eI0M0pH7YArN3QTtXhiGqZ6jfwUYAM34jFZgajuiAAAAAElFTkSuQmCC"},MdzM:function(t,s){},ZT48:function(t,s,e){t.exports=e.p+"static/img/users.cd4ca0c.png"},mznL:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("Gu7T"),a=e.n(i),n=e("qwAB"),o=e("y/jF"),l=e("mvHQ"),c=e.n(l),d=e("Dd8w"),m=e.n(d),r=e("u/8N"),g=e("bVEx"),u=e("HnM+"),h=e("H+gd"),p=e("HsgS"),v=e("NYxO"),y=e("e8pW"),D=null,I={open:91001,save:91002,get:91003,delete:91004,deleteAll:91005,add:91006,ok:9e4},f={data:function(){return{message:"",ishowFile:!0,list:{},showList:[],filelist:[],addDataMsg:{},oldtime:"",timecha:0,timeType:!1,statusMessage:0,pageSize:2,pageNumber:10,type:!1,typelist:[],loadingmore:!1,scrollToEndFlag:!1,cid:this.$route.query.cid,companyName:this.$route.query.companyName,companyImg:this.$route.query.companyImg||"",tel:this.$route.query.tel,companyId:this.$route.query.companyId}},created:function(){this.oldtime=new Date,this._getindexDB(this.cid,this.userId),this.websockets(),this._adddata()},mounted:function(){var t=this;this.$bus.on("communicationmessage",function(s){t._getindexDB(t.cid,t.userId)})},computed:{userId:function(){return this.$store.state.user.userId||""},myName:function(){return this.$store.state.user.loginData.company||this.$store.state.user.loginData.phone||""},myinformation:function(){return"string"==typeof this.$store.state.user.loginData?JSON.parse(this.$store.state.user.loginData):this.$store.state.user.loginData}},methods:m()({websockets:function(){this.userId?D=new WebSocket(r.i+"?uid="+this.userId+"&type=app"):this.$router.push("login")}},Object(v.d)({setstatusmessage:"SET_STATUSMESSAGE",setsendtype:"SET_SENDTYPE"}),{_adddata:function(){if("/communication"===this.$route.path){this.statusMessage=0;var t=this.cid+"&"+this.userId;this.setstatusmessage(!1),Object(u.a)([],this.statusMessage,t,function(t){t!==I.add&&console.log("状态重设为0")})}},_getindexDB:function(t,s){var e=this;console.log("第一次查询getindexeDB");var i=t+"&"+s;Object(u.f)(function(t,s){t!==I.open&&s&&Object(u.e)("",i,function(t){t!==I.get&&(e.list=t||{},e.list.list=e.list.list||[],e.list.countId=e.list.cid||i,e.type?e.showList.push(e.list.list[e.list.list.length-1]):(e.typelist=e.list.list,e.showList=e._getNumber(e.typelist,1,e.pageNumber),e.type=!0))})})},_addData:function(t,s,e,i){var a=this,n=t+"&"+s;e.countId=n,Object(u.f)(function(t,s){t!==I.open&&s&&Object(u.a)(e,i,n,function(t){t!==I.add&&(console.log("数据添加成功_addData"),a._getindexDB(a.cid,a.userId))})})},_sends:function(t){if(t){if(!D.readyState||D.readyState>1)return this.$vux.toast.text("网络异常...","middle"),void this.websockets();D.send(t),console.log("发送成功")}},sends:function(){if(this.message){var t=this._sendData(this.message,"txt");this._sends(t),this.addDataMsg={flag:2,msg:this.message,contentType:"txt",time:Object(h.a)(this.oldtime,"yyyy-MM-dd HH:mm:ss"),timeType:this.timeType,oncId:this.cid,onuserId:this.userId},this.statusMessage=0,this._addData(this.addDataMsg.oncId,this.addDataMsg.onuserId,this.addDataMsg,this.statusMessage)}this.message=""},getFile:function(t){var s=this;this.filelist=[];var e=Object(g.a)(t);this.ishowFile=!1,this.$http.post(r.b,e).then(function(t){var e=t.data.data.split(",");if(e.length>0)for(var i=0;i<e.length;i++)if(s.filelist.push(e[i]),s.filelist&&s.filelist.length>0){console.log(e[i]);var a=s._sendData(e[i],"img");s._sends(a),s.addDataMsg={flag:2,msg:e[i],contentType:"img",time:Object(h.a)(s.oldtime,"yyyy-MM-dd HH:mm:ss"),timeType:s.timeType,oncId:s.cid,onuserId:s.userId},s.statusMessage=0,s._addData(s.addDataMsg.oncId,s.addDataMsg.onuserId,s.addDataMsg,s.statusMessage),s.ishowFile=!0}}).catch(function(t){s.$vux.toast.text(t,"middle")})},_onopensend:function(){var t=this;this.type||Object(p.c)({typein:this.cid}).then(function(s){if(s&&s.length>0&&"0"!==s[0].open_seller){var e=t._sendData("请问你需要什么帮助吗？","txt");t._sends(e),t.addDataMsg={flag:1,msg:"请问你需要什么帮助吗？",contentType:"txt",time:Object(h.a)(t.oldtime,"yyyy-MM-dd HH:mm:ss"),timeType:t.timeType,oncId:t.cid,onuserId:t.userId},setTimeout(function(){t._getindexDB(t.cid,t.userId)},100),t._addData(t.addDataMsg.oncId,t.addDataMsg.onuserId,t.addDataMsg,t.statusMessage)}}).catch(function(s){t.$vux.toast.text(s.msg,"middle")})},deleDB:function(t){var s=this,e=this.cid+"&"+this.userId;Object(u.c)(e,function(e){e===I.ok&&(s.statusMessage=0,s.$vux.toast.text("删除"+t+"成功！","middle"),s.$router.back())})},_sendData:function(t,s){this.oldtime=new Date,this.timeType=this.timecha>30;var e={from:this.userId,userName:this.myName,to:this.cid,sellUserId:this.cid,bodies:[{type:"txt",msg:"txt"===s?t:{url:Object(y.b)(t),fileType:s,fileName:""}}],ext:{time:Object(h.a)(this.oldtime,"yyyy-MM-dd HH:mm:ss"),timeType:this.timeType}},i={auId:this.cid,message:c()(e)};return c()(i)},_getNumber:function(t,s,e){var i=t.length-(s-1)*e,a=i-e;return i=i<=0?0:i,a=a<=0?0:a,t.slice(a,i)}}),beforeDestroy:function(){this.$bus.off("communicationmessage",this.statusMessage=0)}},A=(o.a,n.a,{mixins:[f],data:function(){return{}},computed:{},mounted:function(){},created:function(){},methods:{imgError:function(t){this.myinformation.head_pic=e("fijr")},imgError1:function(t){this.companyImg=e("ZT48")},imgError3:function(t){t.msg=e("Axh0")},goback:function(){this.$router.back()},phoneCall:function(){window.location.href="tel://"+this.tel},scroll:function(t){var s=this,e=this.typelist;if(e.length<=10)this.showList=e;else if(t.y>20&&this.showList.length<e.length){var i=this._getNumber(e,this.pageSize,this.pageNumber);i.length>0&&(this.scrollToEndFlag=!0,this.loadingmore=!0,setTimeout(function(){var t;(t=s.showList).unshift.apply(t,a()(i)),s.pageSize++,s.loadingmore=!1},200))}}},watch:{oldtime:function(t,s){s&&(this.timecha=(t.getTime()-s.getTime())/1e3)},showList:function(t){console.log(t);var s=this.$refs.communbox.clientHeight;this.type&&!this.scrollToEndFlag&&(console.log(s),this.$refs.scroll.scrollTo(0,-s)),this.$refs.scroll.scrollTo(0,-s)}},components:{Loading:o.a,Scroll:n.a}}),M={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("transition",{attrs:{name:"slide"}},[i("div",{staticClass:"fixedBox"},[i("div",{staticClass:"fixedtop"},[i("div",{staticClass:"header"},[i("a",{staticClass:"iconfont icon-back1 fs48 left cfff",attrs:{href:"javascript:;"},on:{click:t.goback}}),t._v(" "),i("span",{staticClass:"txt",on:{click:function(s){t.deleDB(t.companyName)}}},[t._v(t._s(t.companyName))]),t._v(" "),i("div",{staticClass:"add"},[i("i",{staticClass:"iconfont icon-custom-phone fs48",on:{click:t.phoneCall}}),t._v(" "),i("router-link",{staticClass:"seller",attrs:{tag:"div",to:{name:"introduce",params:{sellerId:t.companyId}}}},[t._v("进卖家")])],1)])]),t._v(" "),i("scroll",{ref:"scroll",staticClass:"nominate-content",attrs:{"listen-scroll":!0,data:t.list.list,scrollToEndFlag:!0},on:{scroll:t.scroll}},[i("div",{ref:"communbox",staticClass:"communbox"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.loadingmore,expression:"loadingmore"}],staticClass:"loadmore"},[i("loading")],1),t._v(" "),t._l(this.list.list,function(s,e){return i("div",{key:e,staticClass:"clearfix border"},[1===s.flag?i("div",{staticClass:"others  mt30"},[s.timeType?i("div",{staticClass:"comTims"},[i("p",[t._v(t._s(s.time))])]):t._e(),t._v(" "),i("div",{staticClass:"userimg touxiang person"},[i("img",{attrs:{src:t.companyImg,alt:""},on:{error:function(s){t.imgError1(t.companyImg)}}})]),t._v(" "),"txt"==s.contentType?i("div",{staticClass:"comtxt relative comboxbgOne message"},[i("span",{staticClass:"triangle"}),t._v(" "),i("span",[t._v(t._s(s.msg))])]):t._e(),t._v(" "),"img"==s.contentType?i("div",{staticClass:"comtxt relative comboxbgOne messageimg"},[i("span",{staticClass:"triangle"}),t._v(" "),i("span",[i("img",{staticClass:"contentimg",attrs:{src:s.msg,alt:""},on:{error:function(e){t.imgError3(s)}}})])]):t._e()]):t._e(),t._v(" "),2===s.flag?i("div",{staticClass:" mys  mt30"},[s.timeType?i("div",{staticClass:"comTims"},[i("p",[t._v(t._s(s.time))])]):t._e(),t._v(" "),i("div",{staticClass:"userimg touxiang person"},[i("img",{attrs:{src:t.myinformation.head_pic,alt:""},on:{error:function(e){t.imgError(s)}}})]),t._v(" "),"txt"==s.contentType?i("div",{staticClass:"comtxt relative comboxbgOne message"},[i("span",{staticClass:"triangle"}),t._v(" "),i("span",[t._v(t._s(s.msg))])]):t._e(),t._v(" "),"img"==s.contentType?i("div",{staticClass:"comtxt relative comboxbgOne messageimg"},[i("span",{staticClass:"triangle"}),t._v(" "),i("span",[i("img",{staticClass:"contentimg",attrs:{src:s.msg,alt:""},on:{error:function(e){t.imgError3(s)}}})])]):t._e()]):t._e()])})],2)]),t._v(" "),i("div",{staticClass:"comlodemessage"},[i("div",{staticClass:"inblock comInput"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{type:"text"},domProps:{value:t.message},on:{input:function(s){s.target.composing||(t.message=s.target.value)}}})]),t._v(" "),i("div",{staticClass:"inblock comImg"},[i("img",{attrs:{src:e("xRw8"),alt:""}}),t._v(" "),t.ishowFile?i("input",{ref:"referenceUpload",staticClass:"addbtnipn",attrs:{type:"file",multiple:"multiple"},on:{change:function(s){t.getFile(s)}}}):t._e()]),t._v(" "),i("div",{staticClass:"inblock sublimes",on:{click:t.sends}},[t._v("发表")])])],1)])},staticRenderFns:[]};var b=e("VU/8")(A,M,!1,function(t){e("MdzM")},"data-v-113e1e84",null);s.default=b.exports},xRw8:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAAwCAYAAABE1blzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Nzc5NzQzODMzQjlCMTFFODgwRTk5QzI5MUZCQkUzQjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Nzc5NzQzODQzQjlCMTFFODgwRTk5QzI5MUZCQkUzQjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3Nzk3NDM4MTNCOUIxMUU4ODBFOTlDMjkxRkJCRTNCNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3Nzk3NDM4MjNCOUIxMUU4ODBFOTlDMjkxRkJCRTNCNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXR75kAAALpSURBVHja7JhLaBQxGMcza1sVRCvS6kEvSkFF9DCi2IIHDyqigqcqUlErPqD14JvaQgXBF+hBDyqoKCKK4MHiW2sLWi87N1EsXrzUg1Ct+K44/j+IZQmzm2Q24ybD/uHH7mSy2f3vl3z5Jl42m53HGLsK5rB06Yzv+60eDL7HxRSWTrVmUmyO1FIR0fgO9IEMxwX9ApPAcqG9WjT4FtCa/OZKiLDORt4HQbAVL+dybv8WI9TrkrkIdQnXoWiwyvE1N15sEKeoZ+GPnsv5Cl6BNwX6ejKDoUXGloJOsEhoz4IOcF9lkIylEVwPHkSYI80H98CSOAZt0ExeWcl0V2UPtzGCRxT7jQZtsiVmWwTHgsUa/ddh76vUiWCpk0wNmKDRv1rW37Yp+lmz0PgChlxKMp/AS43+z1CqDbuWRQ9r9O3UzaIm1uBUsFF1n8qT/k8rmguEtj9JG9wE+sEl8ERxP4vSTnAIfI+4Nwh28/tSmaxFl4GLERUJfcfaGONRhM6DRlAHfvI/7zr4qDqIKYN1fGpFqZEnj+0xxh0Ap4qZUiaSDG3O3ZKxtmlUKEZlwuAjnlhkOgD2ltqgbpK5ABo0+h/n0SykiWA/2GDCYEURn90DNsf43Fm+Jm9E3KsHt8Bkfk116RaNsY0V2yvBiSL+HMqEK8TCGTzPMUdqVtwTlSOoMkXpea3LwOy5A3aB12A12JGnXwuvUQ+aMCiL6Djw1GAOOKnYr42bPJZ0Fn3ISncSfpRHMzGDl/OckfxP0XpsSsLgPlNp24CugFUms+iaOHM/Yd1mhk7VZvF9yUY9BguLMUjnHT3MXtGDQU8QBLMLPSyIBkflvKeD11pmt8ZQcQCT0/MFTGwYylnIC5gbopnWB5NVvu/3ywwO8KTSxNwSlXfdMDkDrx8KVTJU2E5jboqeal6IQRMNumrun2qSeOC1WmWDZYNlgyVVZdoN/iCDwyk2eI0M0pH7YArN3QTtXhiGqZ6jfwUYAM34jFZgajuiAAAAAElFTkSuQmCC"}});